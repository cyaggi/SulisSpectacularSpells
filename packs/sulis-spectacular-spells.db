{"name":"Tsu Campaign","img":null,"caption":"","sort":0,"description":"<p>Curtis' enhancements for Tsu Campaign</p>","actors":[],"combats":[],"items":[],"journal":[],"scenes":[],"tables":[],"macros":[],"cards":[],"playlists":[],"folders":[],"_id":"9TzxmhKvjaHom8fw","flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672729262016,"modifiedTime":1672729262016,"lastModifiedBy":"WskHohnEKJHmL1sC"}}
{"name":"Tsu Campaign","img":null,"caption":"","sort":0,"description":"<p>Curtis' enhancements for Tsu Campaign</p>","actors":[],"combats":[],"items":[],"journal":[],"scenes":[],"tables":[],"macros":[{"name":"Spiritual Weapon","type":"script","scope":"global","author":"WskHohnEKJHmL1sC","img":"modules/sulis-spectacular-spells/images/Trinni%27s%20green%20spiritual%20weapon.webp","command":"// You need the Warpgate module and an actor named \"Goblin\" in your Actors Tab for this macro to work. You can change the creature's name below.\n// You also need the Sequencer module and the JB2A module of course !\nconst creatureName = \"Trinni's Spiritual Weapon\";\nconst [spawnedCreature] = await warpgate.spawn(creatureName, { token: { alpha: 0 }}); // This will spawn a token from the \"Goblin\" actor with an opacity of 0.\nconsole.log(spawnedCreature);\nconst tokenD = canvas.tokens.get(spawnedCreature);\nconsole.log(tokenD);\nconst effectScale = 1;\nconst tokenSize = (tokenD.data.width + tokenD.data.height) /2;\nnew Sequence()\n//Will play the intro sequence of the red evocation magic circle animation.\n    .effect()\n        .file(\"jb2a.cure_wounds.200px.purple\")\n        .scale(effectScale * tokenSize)\n        .atLocation(tokenD)\n        .belowTokens() \n        //.waitUntilFinished(-600)\n//Then it will transition to the loop sequence of the red evocation magic circle animation.\n/*\n    .effect()\n        .file(\"jb2a.magic_signs.circle.02.conjuration.loop.dark_red\")\n        .scale(effectScale * tokenSize)\n        .atLocation(tokenD)\n        .belowTokens() \n        .fadeIn(200)\n        .fadeOut(200)\n        .waitUntilFinished(-2550)\n        \n//This is an animation that will \"hide\" the apparition of the token\n    .effect()\n        .file(\"jb2a.divine_smite.target.dark_red\")\n        .scale(0.5 * tokenSize)\n        .atLocation(tokenD)\n        .waitUntilFinished(-1500)\n        */\n        \n//Let's bring the opacity of the token back whilst the Divine Smite animation is here\n    .animation()\n        .delay(400)\n        .on(tokenD)\n        .fadeIn(500)\n        .opacity(1.0)\n        \n//Finally it will play the outro sequence of the red evocation magic circle animation as follow : jb2a.magic_signs.circle.02.schoolofmagicname.outro.color\n/*\n    .effect()\n        .file(\"jb2a.magic_signs.circle.02.conjuration.outro.dark_red\")\n        .scale(effectScale * tokenSize)\n        .atLocation(tokenD)\n        .belowTokens() \n        */\n    .play()","folder":null,"sort":0,"ownership":{"default":0,"WskHohnEKJHmL1sC":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.IE5MbNGjRpzXPDZE"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672213058406,"modifiedTime":1672729736778,"lastModifiedBy":"WskHohnEKJHmL1sC"},"_id":"IE5MbNGjRpzXPDZE"},{"name":"Warping Whirlpool","type":"script","scope":"global","author":"WskHohnEKJHmL1sC","img":"modules/sulis-spectacular-spells/images/Vortex_01_Regular_Blue_Thumb.webp","command":"// requires Warpgate, Sequencer, and JB2A patreon module\n\nlet distanceAvailable = 30;\nlet icon = 'icons/magic/control/silhouette-grow-shrink-blue.webp';\nlet updateItem = async () => {};\n\nif (typeof item !== 'undefined') {\n    distanceAvailable = item.data.data.uses.value * 5;\n    icon = item.data.img;\n    updateItem = async () => {\n        const updatedCharges = item.data.data.uses.value - crosshairsDistance / 5;\n        await item.update({ 'data.uses.value': updatedCharges });\n    };\n}\n\nlet crosshairsDistance = 0;\nconst checkDistance = async (crosshairs) => {\n    while (crosshairs.inFlight) {\n        //wait for initial render\n        await warpgate.wait(100);\n\n        const ray = new Ray(token.center, crosshairs);\n        const distance = canvas.grid.measureDistances([{ ray }], { gridSpaces: true })[0];\n\n        //only update if the distance has changed\n        if (crosshairsDistance !== distance) {\n            crosshairsDistance = distance;\n            if (distance > distanceAvailable) {\n                crosshairs.icon = 'icons/svg/hazard.svg';\n            } else {\n                crosshairs.icon = icon;\n            }\n\n            crosshairs.draw();\n            crosshairs.label = `${distance} ft`;\n        }\n    }\n}\n\nconst location = await warpgate.crosshairs.show(\n    {\n        // swap between targeting the grid square vs intersection based on token's size\n        interval: token.data.width % 2 === 0 ? 1 : -1,\n        size: token.data.width,\n        icon: icon,\n        label: '0 ft.',\n    },\n    {\n        show: checkDistance\n    },\n);\n\nif (location.cancelled || crosshairsDistance > distanceAvailable) {\n    return;\n}\n\nconst seq = new Sequence().effect()\n    .file(\"jb2a.template_circle.whirl.intro.blue\") \n    .atLocation(token)\n    .zIndex(1)\n    .scale(0.25)\n    .delay(200)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.intro.blue\")\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\n    .waitUntilFinished(-1000)\n    .fadeOut(1000)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.outro.blue\") //Edit this line to customize the outro animation.\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\n    \n    .thenDo(async () => { await updateItem(); });\nseq.animation()\n    .on(token)\n    .fadeOut(500)\n    .duration(500)\n    .waitUntilFinished();\nseq.animation()\n    .on(token)\n    .teleportTo(location, { relativeToCenter: true })\n    .waitUntilFinished();\nseq.animation()\n    .on(token)\n    .fadeIn(1000)\n    .waitUntilFinished(-999);\nseq.effect()\n    .file(\"jb2a.template_circle.whirl.intro.blue\") \n    .atLocation(token)\n    .zIndex(1)\n    .scale(0.25)\n    .delay(200)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.intro.blue\")\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\n    .waitUntilFinished(-1000)\n    .fadeOut(1000)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.outro.blue\") //Edit this line to customize the outro animation.\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\nawait seq.play();","folder":null,"sort":0,"ownership":{"default":0,"WskHohnEKJHmL1sC":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.YL8sQTdAyL3rAoVW"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672708680619,"modifiedTime":1672729797917,"lastModifiedBy":"WskHohnEKJHmL1sC"},"_id":"YL8sQTdAyL3rAoVW"}],"cards":[],"playlists":[],"folders":[],"_id":"9TzxmhKvjaHom8fw","flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672729262016,"modifiedTime":1672729974074,"lastModifiedBy":"WskHohnEKJHmL1sC"}}
{"name":"Tsu Campaign","img":null,"caption":"","sort":0,"description":"<p>Curtis' enhancements for Tsu Campaign</p>","actors":[{"name":"Trinni's Spiritual Weapon","type":"npc","flags":{"core":{"sourceId":"Compendium.jb2a_patreon.jb2a-actors.mnf54fQUAcD0rr9K"},"midi-qol":{"concentration-damage":0}},"img":"Tokens/trinni_s_spiritual_weapon.Avatar.webp?1672362182498","items":[],"effects":[],"system":{"abilities":{"str":{"value":10,"proficient":0,"bonuses":{"check":"","save":""},"mod":0,"prof":0,"saveBonus":0,"checkBonus":0,"save":0,"dc":10},"dex":{"value":10,"proficient":0,"bonuses":{"check":"","save":""},"mod":0,"prof":0,"saveBonus":0,"checkBonus":0,"save":0,"dc":10},"con":{"value":10,"proficient":0,"bonuses":{"check":"","save":""},"mod":0,"prof":0,"saveBonus":0,"checkBonus":0,"save":0,"dc":10},"int":{"value":10,"proficient":0,"bonuses":{"check":"","save":""},"mod":0,"prof":0,"saveBonus":0,"checkBonus":0,"save":0,"dc":10},"wis":{"value":10,"proficient":0,"bonuses":{"check":"","save":""},"mod":0,"prof":0,"saveBonus":0,"checkBonus":0,"save":0,"dc":10},"cha":{"value":10,"proficient":0,"bonuses":{"check":"","save":""},"mod":0,"prof":0,"saveBonus":0,"checkBonus":0,"save":0,"dc":10}},"attributes":{"ac":{"flat":null,"calc":"default","formula":"","value":0},"hp":{"value":0,"min":0,"max":0,"temp":null,"tempmax":0,"formula":""},"init":{"value":0,"bonus":0,"mod":0,"prof":0,"total":0},"movement":{"burrow":0,"climb":0,"fly":0,"swim":0,"walk":20,"units":"ft","hover":false},"attunement":{"max":3},"senses":{"darkvision":0,"blindsight":0,"tremorsense":0,"truesight":0,"units":"ft","special":""},"spellcasting":"int","prof":2,"encumbrance":{"value":0,"max":150,"pct":0,"encumbered":false},"spelldc":10},"details":{"biography":{"value":"","public":""},"alignment":"","race":"","type":"","environment":"","cr":1,"spellLevel":0,"xp":{"value":200},"source":""},"traits":{"size":"med","di":{"value":[],"bypasses":[],"custom":""},"dr":{"value":[],"bypasses":[],"custom":""},"dv":{"value":[],"bypasses":[],"custom":""},"ci":{"value":[],"custom":""},"languages":{"value":[],"custom":""}},"currency":{"pp":0,"gp":0,"ep":0,"sp":0,"cp":0},"skills":{"acr":{"value":0,"ability":"dex","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"ani":{"value":0,"ability":"wis","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"arc":{"value":0,"ability":"int","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"ath":{"value":0,"ability":"str","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"dec":{"value":0,"ability":"cha","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"his":{"value":0,"ability":"int","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"ins":{"value":0,"ability":"wis","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"itm":{"value":0,"ability":"cha","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"inv":{"value":0,"ability":"int","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"med":{"value":0,"ability":"wis","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"nat":{"value":0,"ability":"int","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"prc":{"value":0,"ability":"wis","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"prf":{"value":0,"ability":"cha","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"per":{"value":0,"ability":"cha","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"rel":{"value":0,"ability":"int","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"slt":{"value":0,"ability":"dex","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"ste":{"value":0,"ability":"dex","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10},"sur":{"value":0,"ability":"wis","bonuses":{"check":"","passive":""},"bonus":0,"mod":0,"prof":0,"total":0,"passive":10}},"spells":{"spell1":{"value":0,"override":null,"max":0},"spell2":{"value":0,"override":null,"max":0},"spell3":{"value":0,"override":null,"max":0},"spell4":{"value":0,"override":null,"max":0},"spell5":{"value":0,"override":null,"max":0},"spell6":{"value":0,"override":null,"max":0},"spell7":{"value":0,"override":null,"max":0},"spell8":{"value":0,"override":null,"max":0},"spell9":{"value":0,"override":null,"max":0},"pact":{"value":0,"override":null,"max":0,"level":0}},"bonuses":{"mwak":{"attack":"","damage":""},"rwak":{"attack":"","damage":""},"msak":{"attack":"","damage":""},"rsak":{"attack":"","damage":""},"abilities":{"check":"","save":"","skill":""},"spell":{"dc":""}},"resources":{"legact":{"value":0,"max":0},"legres":{"value":0,"max":0},"lair":{"value":false,"initiative":0}}},"ownership":{"default":0,"WskHohnEKJHmL1sC":3},"prototypeToken":{"flags":{"tagger":{"tags":""},"warpgate":{"sourceActorId":"hAKmgYuBcja7s7rV"}},"name":"Trinni's Spiritual Weapon","displayName":0,"width":1,"height":1,"lockRotation":false,"rotation":0,"actorLink":false,"disposition":0,"displayBars":0,"bar1":{"attribute":"attributes.hp"},"bar2":{"attribute":null},"randomImg":false,"light":{"dim":0,"bright":0,"angle":360,"color":null,"alpha":1,"animation":{"type":null,"speed":5,"intensity":5,"reverse":false},"coloration":1,"attenuation":0.5,"luminosity":0.5,"saturation":0,"contrast":0,"shadows":0,"darkness":{"min":0,"max":1}},"texture":{"src":"modules/jb2a_patreon/Library/2nd_Level/Spiritual_Weapon/SpiritualWeapon_Quarterstaff03_01_Astral_Purple_400x400.webm","tint":"#51ff00","scaleX":1.8,"scaleY":1.8,"offsetX":0,"offsetY":0,"rotation":0},"sight":{"angle":360,"enabled":false,"range":0,"brightness":1,"visionMode":"basic","color":null,"attenuation":0.1,"saturation":0,"contrast":0},"alpha":1,"detectionModes":[]},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672212681521,"modifiedTime":1672363037064,"lastModifiedBy":"WskHohnEKJHmL1sC"},"folder":null,"sort":0,"_id":"hAKmgYuBcja7s7rV"}],"combats":[],"items":[],"journal":[],"scenes":[],"tables":[],"macros":[{"name":"Spiritual Weapon","type":"script","scope":"global","author":"WskHohnEKJHmL1sC","img":"modules/sulis-spectacular-spells/images/Trinni%27s%20green%20spiritual%20weapon.webp","command":"// You need the Warpgate module and an actor named \"Goblin\" in your Actors Tab for this macro to work. You can change the creature's name below.\n// You also need the Sequencer module and the JB2A module of course !\nconst creatureName = \"Trinni's Spiritual Weapon\";\nconst [spawnedCreature] = await warpgate.spawn(creatureName, { token: { alpha: 0 }}); // This will spawn a token from the \"Goblin\" actor with an opacity of 0.\nconsole.log(spawnedCreature);\nconst tokenD = canvas.tokens.get(spawnedCreature);\nconsole.log(tokenD);\nconst effectScale = 1;\nconst tokenSize = (tokenD.data.width + tokenD.data.height) /2;\nnew Sequence()\n//Will play the intro sequence of the red evocation magic circle animation.\n    .effect()\n        .file(\"jb2a.cure_wounds.200px.purple\")\n        .scale(effectScale * tokenSize)\n        .atLocation(tokenD)\n        .belowTokens() \n        //.waitUntilFinished(-600)\n//Then it will transition to the loop sequence of the red evocation magic circle animation.\n/*\n    .effect()\n        .file(\"jb2a.magic_signs.circle.02.conjuration.loop.dark_red\")\n        .scale(effectScale * tokenSize)\n        .atLocation(tokenD)\n        .belowTokens() \n        .fadeIn(200)\n        .fadeOut(200)\n        .waitUntilFinished(-2550)\n        \n//This is an animation that will \"hide\" the apparition of the token\n    .effect()\n        .file(\"jb2a.divine_smite.target.dark_red\")\n        .scale(0.5 * tokenSize)\n        .atLocation(tokenD)\n        .waitUntilFinished(-1500)\n        */\n        \n//Let's bring the opacity of the token back whilst the Divine Smite animation is here\n    .animation()\n        .delay(400)\n        .on(tokenD)\n        .fadeIn(500)\n        .opacity(1.0)\n        \n//Finally it will play the outro sequence of the red evocation magic circle animation as follow : jb2a.magic_signs.circle.02.schoolofmagicname.outro.color\n/*\n    .effect()\n        .file(\"jb2a.magic_signs.circle.02.conjuration.outro.dark_red\")\n        .scale(effectScale * tokenSize)\n        .atLocation(tokenD)\n        .belowTokens() \n        */\n    .play()","folder":null,"sort":0,"ownership":{"default":0,"WskHohnEKJHmL1sC":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.IE5MbNGjRpzXPDZE"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672213058406,"modifiedTime":1672729736778,"lastModifiedBy":"WskHohnEKJHmL1sC"},"_id":"IE5MbNGjRpzXPDZE"},{"name":"Warping Whirlpool","type":"script","scope":"global","author":"WskHohnEKJHmL1sC","img":"modules/sulis-spectacular-spells/images/Vortex_01_Regular_Blue_Thumb.webp","command":"// requires Warpgate, Sequencer, and JB2A patreon module\n\nlet distanceAvailable = 30;\nlet icon = 'icons/magic/control/silhouette-grow-shrink-blue.webp';\nlet updateItem = async () => {};\n\nif (typeof item !== 'undefined') {\n    distanceAvailable = item.data.data.uses.value * 5;\n    icon = item.data.img;\n    updateItem = async () => {\n        const updatedCharges = item.data.data.uses.value - crosshairsDistance / 5;\n        await item.update({ 'data.uses.value': updatedCharges });\n    };\n}\n\nlet crosshairsDistance = 0;\nconst checkDistance = async (crosshairs) => {\n    while (crosshairs.inFlight) {\n        //wait for initial render\n        await warpgate.wait(100);\n\n        const ray = new Ray(token.center, crosshairs);\n        const distance = canvas.grid.measureDistances([{ ray }], { gridSpaces: true })[0];\n\n        //only update if the distance has changed\n        if (crosshairsDistance !== distance) {\n            crosshairsDistance = distance;\n            if (distance > distanceAvailable) {\n                crosshairs.icon = 'icons/svg/hazard.svg';\n            } else {\n                crosshairs.icon = icon;\n            }\n\n            crosshairs.draw();\n            crosshairs.label = `${distance} ft`;\n        }\n    }\n}\n\nconst location = await warpgate.crosshairs.show(\n    {\n        // swap between targeting the grid square vs intersection based on token's size\n        interval: token.data.width % 2 === 0 ? 1 : -1,\n        size: token.data.width,\n        icon: icon,\n        label: '0 ft.',\n    },\n    {\n        show: checkDistance\n    },\n);\n\nif (location.cancelled || crosshairsDistance > distanceAvailable) {\n    return;\n}\n\nconst seq = new Sequence().effect()\n    .file(\"jb2a.template_circle.whirl.intro.blue\") \n    .atLocation(token)\n    .zIndex(1)\n    .scale(0.25)\n    .delay(200)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.intro.blue\")\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\n    .waitUntilFinished(-1000)\n    .fadeOut(1000)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.outro.blue\") //Edit this line to customize the outro animation.\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\n    \n    .thenDo(async () => { await updateItem(); });\nseq.animation()\n    .on(token)\n    .fadeOut(500)\n    .duration(500)\n    .waitUntilFinished();\nseq.animation()\n    .on(token)\n    .teleportTo(location, { relativeToCenter: true })\n    .waitUntilFinished();\nseq.animation()\n    .on(token)\n    .fadeIn(1000)\n    .waitUntilFinished(-999);\nseq.effect()\n    .file(\"jb2a.template_circle.whirl.intro.blue\") \n    .atLocation(token)\n    .zIndex(1)\n    .scale(0.25)\n    .delay(200)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.intro.blue\")\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\n    .waitUntilFinished(-1000)\n    .fadeOut(1000)\nseq.effect()\n    .file(\"jb2a.template_circle.vortex.outro.blue\") //Edit this line to customize the outro animation.\n    .scale(0.5)\n    .atLocation(token)\n    .zIndex(2)\nawait seq.play();","folder":null,"sort":0,"ownership":{"default":0,"WskHohnEKJHmL1sC":3},"flags":{"combat-utility-belt":{"macroTrigger":""},"core":{"sourceId":"Macro.YL8sQTdAyL3rAoVW"}},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672708680619,"modifiedTime":1672729797917,"lastModifiedBy":"WskHohnEKJHmL1sC"},"_id":"YL8sQTdAyL3rAoVW"}],"cards":[],"playlists":[],"folders":[],"_id":"9TzxmhKvjaHom8fw","flags":{},"_stats":{"systemId":"dnd5e","systemVersion":"2.0.3","coreVersion":"10.291","createdTime":1672729262016,"modifiedTime":1672730018975,"lastModifiedBy":"WskHohnEKJHmL1sC"}}
